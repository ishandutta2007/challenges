/*

In this challenge, we make use of the FourVector class we created in the first three challenges of this series (part 1, part 2, and part 3). We will turn to a (simplified) two-body decay, i.e. one particle decays into two daughter particles. This is a typical situation e.g. in particle physics experiments.

Please extend the FourVector class by a method GetInvariantMass which accepts as parameters a list of 4-vectors (which, in this challenge, will contain exactly one element) and returns the invariant mass of the system of 4-vectors, i.e. the sum of the 4-vector whose instance the method is called upon and the 4-vector(s) from the list. Please see the wiki link in the ressources for details on the invariant mass. It is simply the length of the 4-vector sum.

Furthermore, please provide a function (outside the class FourVector) find_particle which accepts two FourVector instances as input. Based on the invariant mass of these (which makes use of the method mentioned in the previous section), return the name of the particle which decayed into the two daughters which are represented by the two 4-vectors. We will only cover four particles here: the Higgs boson (mass 125.1 GeV), the Sigma+ baryon (mass 1.18937 GeV), the J/Psi meson (mass 3.0969 GeV), and the charged pion (pi meson, mass 0.139570 GeV). Please note that we are using "particle physics units" for mass here, i.e. units where the speed of light and Planck's constant are set to 1.

Names to be returned are "Higgs", "J/Psi", "Sigma+" and "Pi+", respectively.

Please note that masses may not match exactly the values mentioned above, please allow some room for error (see note below).
Examples

fv1 = FourVector([62.55, 7.522814397445341, 50.95236974441615, -35.448674862543086])
fv2 = FourVector([62.55, -7.522814397445341, -50.95236974441615, 35.448674862543086])
find_particle(fv1, fv2) âžž "Higgs"

Notes

In particle physics experiments, various detector components are responsible for measuring the particle's energy and momenta as precisely as possible. Based on these, the particle type and therefore it's rest mass and therefore the complete energy-momentum-four vector can (in principle) be reconstructed. By calculating the invariant mass of several four vectors, searches for mother particles that decayed into the detected particles are possible. In reality, this is much more complicated and many sources of errors are present. To take that into account a bit, the test data contains cases where the mass of the mother particle does match only approximately the values mentioned above.

Details on particle properties like mass and decay modes are provided by the particle data group, see Resources.

*/

#include <cassert>
#include <cstdio>
#include <cstring>
#include <cmath>
#include <vector>

#define nelem(x) (sizeof(x) / sizeof(x[0]))
#define deg2rad(x) (((x)*M_PI) / 180)

using namespace std;

struct FourVector
{
	double t, x, y, z;

	FourVector()
	{
		t = x = y = z = 0;
	}

	FourVector(double t, double x, double y, double z)
		: t(t), x(x), y(y), z(z)
	{
	}

	FourVector operator+(const FourVector &v) const
	{
		return FourVector(t + v.t, x + v.x, y + v.y, z + v.z);
	}

	FourVector operator-(const FourVector &v) const
	{
		return FourVector(t - v.t, x - v.x, y - v.y, z - v.z);
	}

	FourVector operator*(double s) const
	{
		return FourVector(s * t, s * x, s * y, s * z);
	}

	double operator*(const FourVector &v) const
	{
		return t * v.t - x * v.x - y * v.y - z * v.z;
	}

	bool operator==(const FourVector &v) const
	{
		static const auto eps = 1e-6;
		return fabs(t - v.t) < eps &&
			   fabs(x - v.x) < eps &&
			   fabs(y - v.y) < eps &&
			   fabs(z - v.z) < eps;
	}

	double length() const
	{
		return sqrt(fabs(t * t - x * x - y * y - z * z));
	}

	static int kronecker_delta(int i, int j)
	{
		return i == j;
	}

	static int levi_civita(int i, int j, int k)
	{
		if (i == j || i == k || j == k)
			return 0;

		if (i == 1 && j == 2 && k == 3)
			return 1;
		if (i == 2 && j == 3 && k == 1)
			return 1;
		if (i == 3 && j == 1 && k == 2)
			return 1;

		if (i == 1 && j == 3 && k == 2)
			return -1;
		if (i == 2 && j == 1 && k == 3)
			return -1;
		if (i == 3 && j == 2 && k == 1)
			return -1;

		assert(0);
		return 0;
	}

	static FourVector normalize_3d_vector(const FourVector &v)
	{
		double l = sqrt(v.x * v.x + v.y * v.y + v.z * v.z);
		if (l == 0)
			return FourVector();
		return FourVector(0, v.x / l, v.y / l, v.z / l);
	}

	FourVector transform(double m[4][4], const FourVector &v) const
	{
		double t = m[0][0] * v.t + m[0][1] * v.x + m[0][2] * v.y + m[0][3] * v.z;
		double x = m[1][0] * v.t + m[1][1] * v.x + m[1][2] * v.y + m[1][3] * v.z;
		double y = m[2][0] * v.t + m[2][1] * v.x + m[2][2] * v.y + m[2][3] * v.z;
		double z = m[3][0] * v.t + m[3][1] * v.x + m[3][2] * v.y + m[3][3] * v.z;
		return FourVector(t, x, y, z);
	}

	// circular rotations
	FourVector pure_rotation(FourVector axis, double angle) const
	{
		auto r = deg2rad(angle);
		auto c = cos(r);
		auto s = sin(r);
		auto w = normalize_3d_vector(axis);
		double xfm[4][4] = { 0 };
		xfm[1][1] = c + w.x * w.x * (1 - c);
		xfm[1][2] = w.x * w.y * (1 - c) - w.z * s;
		xfm[1][3] = w.y * s + w.x * w.z * (1 - c);
		xfm[2][1] = w.z * s + w.x * w.y * (1 - c);
		xfm[2][2] = c + w.y * w.y * (1 - c);
		xfm[2][3] = -w.x * s + w.y * w.z * (1 - c);
		xfm[3][1] = -w.y * s + w.x * w.z * (1 - c);
		xfm[3][2] = w.x * s + w.y * w.z * (1 - c);
		xfm[3][3] = c + w.z * w.z * (1 - c);
		xfm[0][0] = 1;
		return transform(xfm, *this);
	}

	// hyperbolic rotations
	FourVector pure_boost(FourVector vel) const
	{
		static const double c = 299792458;

		double B[] = { 0, vel.x / c, vel.y / c, vel.z / c };
		double L = B[1] * B[1] + B[2] * B[2] + B[3] * B[3];
		double y = 1 / sqrt(1 - L);

		double xfm[4][4] = { 0 };
		xfm[0][0] = y;
		for (int i = 1; i <= 3; i++)
			xfm[i][0] = xfm[0][i] = -y * B[i];
		for (int i = 1; i <= 3; i++)
		{
			for (int j = 1; j <= 3; j++)
				xfm[i][j] = ((y - 1) * (B[i] * B[j]) / L) + kronecker_delta(i, j);
		}

		return transform(xfm, *this);
	}

	double invariant_mass()
	{
		return sqrt(t * t - (x * x + y * y + z * z));
	}

	void components(double r[4]) const
	{
		r[0] = t;
		r[1] = x;
		r[2] = y;
		r[3] = z;
	}

	const char *structure() const
	{
		double p = t * t - x * x - y * y - z * z;
		if (p < 0)
			return "spacelike";
		if (p > 0)
			return "timelike";
		return "lightlike";
	}

	char *string(char *b) const
	{
		sprintf(b, "(%.3f, %.3f, %.3f, %.3f)", t, x, y, z);
		return b;
	}
};

FourVector operator*(double s, const FourVector &v)
{
	return FourVector(s * v.t, s * v.x, s * v.y, s * v.z);
}

const char *find_particle(const FourVector &a, const FourVector &b)
{
	static const struct
	{
		const char *name;
		double value;
	} tab[] = {
		{ "Higgs", 125.1 },
		{ "Sigma+", 1.18937 },
		{ "J/Psi", 3.0969 },
		{ "Pi+", 0.139570 },
	};

	auto m = (a + b).invariant_mass();
	for (size_t i = 0; i < nelem(tab); i++)
	{
		auto &t = tab[i];
		if (fabs(m - t.value) < 1e-1)
			return tab[i].name;
	}
	return "Unknown";
}

struct Test
{
	FourVector v1;
	FourVector v2;
	char particle[32];
	char frame[32];
};

int main()
{
	Test test_data[] = {
		{ { 0.10977816924920972, 0.004198527919697148, -0.01710355458643327, 0.02402902335302364 },
		  { 0.02979183075079029, -0.004198527919697148, 0.01710355458643327, -0.02402902335302364 },
		  "Pi+",
		  "Lab frame" },
		{ { 0.10977816924920972, -0.002674642237530488, -0.0038337085668441505, -0.029422816775581805 },
		  { 0.02979183075079029, 0.002674642237530488, 0.0038337085668441505, 0.029422816775581805 },
		  "Pi+",
		  "Lab frame" },
		{ { 0.10977816924920972, 0.0019021076852338348, 0.001827458966316865, 0.029674830404973453 },
		  { 0.02979183075079029, -0.0019021076852338348, -0.001827458966316865, -0.029674830404973453 },
		  "Pi+",
		  "Lab frame" },
		{ { 0.10977816924920972, -0.00247235035476628, -0.0008326188960138736, 0.02967738885045351 },
		  { 0.02979183075079029, 0.00247235035476628, 0.0008326188960138736, -0.02967738885045351 },
		  "Pi+",
		  "Lab frame" },
		{ { 0.10977816924920972, 0.00841269235670759, 0.022083506967352017, -0.018141072372328024 },
		  { 0.02979183075079029, -0.00841269235670759, -0.022083506967352017, 0.018141072372328024 },
		  "Pi+",
		  "Lab frame" },
		{ { 1.54845, -0.09917584166284826, 0.6157941381081555, -1.4133277896998542 },
		  { 1.54845, 0.09917584166284826, -0.6157941381081555, 1.4133277896998542 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, 0.6932088274949965, 1.3496183841690221, -0.2907326053812784 },
		  { 1.54845, -0.6932088274949965, -1.3496183841690221, 0.2907326053812784 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, -0.3363712387095841, -0.5077907264929482, 1.4196959805157299 },
		  { 1.54845, 0.3363712387095841, 0.5077907264929482, -1.4196959805157299 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, -0.705283100673264, 0.8670753236918147, -1.066437921393091 },
		  { 1.54845, 0.705283100673264, -0.8670753236918147, 1.066437921393091 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, -0.21743230090129484, -1.453325372373518, -0.47655247956119173 },
		  { 1.54845, 0.21743230090129484, 1.453325372373518, 0.47655247956119173 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, -1.5006413632901694, 0.3757537847110444, -0.06768850299734254 },
		  { 1.54845, 1.5006413632901694, -0.3757537847110444, 0.06768850299734254 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, 0.5765935703639253, 0.8325308800107338, 1.1713792425272047 },
		  { 1.54845, -0.5765935703639253, -0.8325308800107338, -1.1713792425272047 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, -0.617394331775924, 0.5036214864355429, 1.3277374660946675 },
		  { 1.54845, 0.617394331775924, -0.5036214864355429, -1.3277374660946675 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, -1.2183374851505735, 0.5103017723929394, 0.8080488937865548 },
		  { 1.54845, 1.2183374851505735, -0.5103017723929394, -0.8080488937865548 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, 0.5134499198293837, 1.0506159342313537, 1.0150233888667064 },
		  { 1.54845, -0.5134499198293837, -1.0506159342313537, -1.0150233888667064 },
		  "J/Psi",
		  "Lab frame" },
		{ { 62.55, -11.620094135437196, 25.70795922571112, -55.79802427750603 },
		  { 62.55, 11.620094135437196, -25.70795922571112, 55.79802427750603 },
		  "Higgs",
		  "Lab frame" },
		{ { 62.55, 62.02289075513826, 3.553768498877902, 7.062366485319717 },
		  { 62.55, -62.02289075513826, -3.553768498877902, -7.062366485319717 },
		  "Higgs",
		  "Lab frame" },
		{ { 62.55, 6.754891647539515, -28.20440124454387, -55.391591941441554 },
		  { 62.55, -6.754891647539515, 28.20440124454387, 55.391591941441554 },
		  "Higgs",
		  "Lab frame" },
		{ { 62.55, 16.76126377543465, -55.39318405570831, -23.664328964944758 },
		  { 62.55, -16.76126377543465, 55.39318405570831, 23.664328964944758 },
		  "Higgs",
		  "Lab frame" },
		{ { 62.55, 7.522814397445341, 50.95236974441615, -35.448674862543086 },
		  { 62.55, -7.522814397445341, -50.95236974441615, 35.448674862543086 },
		  "Higgs",
		  "Lab frame" },
		{ { 0.9571188840764735, -0.011914505348881327, 0.15897294608523685, -0.10152687943099194 },
		  { 0.2322511159235265, 0.011914505348881327, -0.15897294608523685, 0.10152687943099194 },
		  "Sigma+",
		  "Lab frame" },
		{ { 0.9571188840764735, -0.09841768810255783, -0.04965701297200711, -0.1535258935911753 },
		  { 0.2322511159235265, 0.09841768810255783, 0.04965701297200711, 0.1535258935911753 },
		  "Sigma+",
		  "Lab frame" },
		{ { 0.9571188840764735, -0.0007123867680491012, 0.0039022087635084855, -0.18896117469888363 },
		  { 0.2322511159235265, 0.0007123867680491012, -0.0039022087635084855, 0.18896117469888363 },
		  "Sigma+",
		  "Lab frame" },
		{ { 0.9571188840764735, 0.001996588647722866, 0.005180659416738334, 0.18892123933931532 },
		  { 0.2322511159235265, -0.001996588647722866, -0.005180659416738334, -0.18892123933931532 },
		  "Sigma+",
		  "Lab frame" },
		{ { 0.9571188840764735, -0.06350296725142814, -0.04086160848353933, -0.1732621204248791 },
		  { 0.2322511159235265, 0.06350296725142814, 0.04086160848353933, 0.1732621204248791 },
		  "Sigma+",
		  "Lab frame" },
		{ { 0.10977816924920972, 0.01165927515915811, 0.002462900922721444, 0.02730713094736206 },
		  { 0.02979183075079029, -0.01173114794706078, -0.0024492682407579176, -0.027275161455300696 },
		  "Pi+",
		  "Lab frame" },
		{ { 0.10977816924920972, 0.019576466229448808, -0.009931268716921092, 0.019832457519342345 },
		  { 0.02979183075079029, -0.019792925389452636, 0.009985151431936215, -0.01990201082535626 },
		  "Pi+",
		  "Lab frame" },
		{ { 0.10977816924920972, -0.01623037725922366, 0.02480911768914648, 0.0030062360302721357 },
		  { 0.02979183075079029, 0.016444340718948857, -0.024657582023528524, -0.0030233237596754637 },
		  "Pi+",
		  "Lab frame" },
		{ { 0.10977816924920972, 0.01754743906662003, -0.012119369697364898, 0.021180190248189856 },
		  { 0.02979183075079029, -0.0174147391584962, 0.012108011618513824, -0.020920709695686896 },
		  "Pi+",
		  "Lab frame" },
		{ { 0.10977816924920972, -0.028296929619167816, -0.00025507321492890223, -0.010480613261901606 },
		  { 0.02979183075079029, 0.027923962229271643, 0.00025427536159185996, 0.010379829331084042 },
		  "Pi+",
		  "Lab frame" },
		{ { 1.54845, -0.5055709913901146, -0.949981325156596, 1.1157080123229848 },
		  { 1.54845, 0.5037993278903897, 0.9438293911990053, -1.114408375220629 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, -0.1364310106764822, 0.9092411071917538, 1.2417706056828057 },
		  { 1.54845, 0.13504196204411217, -0.9017662408205658, -1.2470425111596628 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, -0.34547940505077146, 1.1953266620671439, -0.9327766749067963 },
		  { 1.54845, 0.3392270708479568, -1.1750084987989438, 0.9438292914451977 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, -0.21954853626534965, -1.0879091550288644, -1.0823256083285189 },
		  { 1.54845, 0.21949514803094206, 1.0858627895925757, 1.0766882517260417 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, -0.15328927895351904, -0.08873886012483784, -1.543385359719614 },
		  { 1.54845, 0.1536839310036952, 0.08950349443135376, 1.5345696735800574 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, 1.1394326207907952, -0.020303539352919706, -1.0730741749792694 },
		  { 1.54845, -1.1282327692088312, 0.020343990752565454, 1.0603650701073217 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, 0.08826879057453216, -0.2828360239489028, 1.519145062295135 },
		  { 1.54845, -0.08683005075500307, 0.28233846529401513, -1.5200140376593163 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, -0.5874807845447035, -0.00010824221818424133, -1.4147586889187367 },
		  { 1.54845, 0.5878932650748279, 0.00010826489585897655, 1.4325078144772698 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, 0.6255080847019473, 1.1178921367317354, -0.8577309773424766 },
		  { 1.54845, -0.6261383334919479, -1.1185075053322213, 0.8686707599703642 },
		  "J/Psi",
		  "Lab frame" },
		{ { 1.54845, -0.461997237738029, 0.31686142180938637, -1.4454162694902466 },
		  { 1.54845, 0.46097738540840316, -0.3169939250822557, 1.4438531237570709 },
		  "J/Psi",
		  "Lab frame" },
		{ { 62.55, -21.171027734979607, 24.909695333379446, 53.59050934372045 },
		  { 62.55, 21.138634554051606, -24.9034124241695, -53.313445277550535 },
		  "Higgs",
		  "Lab frame" },
		{ { 62.55, -5.748345902751463, 28.153481888528045, 55.7509005714631 },
		  { 62.55, 5.82867004282456, -27.786432556784007, -55.707145321220445 },
		  "Higgs",
		  "Lab frame" },
		{ { 62.55, -3.543630374534022, 6.049100196437618, 62.33206604345203 },
		  { 62.55, 3.526173187061559, -6.029771867108898, -62.13335032352488 },
		  "Higgs",
		  "Lab frame" },
		{ { 62.55, 55.58926820727743, 10.698067108004398, -26.15350116888009 },
		  { 62.55, -55.81459750937525, -10.765733361810216, 26.04179253794271 },
		  "Higgs",
		  "Lab frame" },
		{ { 62.55, 49.373618130943626, -3.0064435726444785, 37.87187484752383 },
		  { 62.55, -49.51567846254014, 3.00179266696021, -38.05958612122999 },
		  "Higgs",
		  "Lab frame" },
		{ { 0.9571188840764735, -0.008526984893754495, 0.003698664021218789, 0.18708664434157557 },
		  { 0.2322511159235265, 0.008555552792773868, -0.0036929540568333592, -0.18877294530325975 },
		  "Sigma+",
		  "Lab frame" },
		{ { 0.9571188840764735, -0.027416683051976053, 0.14786271799865883, 0.11784405468659867 },
		  { 0.2322511159235265, 0.027418266557686356, -0.14573869492876293, -0.11717735161350912 },
		  "Sigma+",
		  "Lab frame" },
		{ { 0.9571188840764735, 0.08420808642874202, -0.1697614212274604, -0.012758501030970454 },
		  { 0.2322511159235265, -0.084716832345746, 0.16848076035867346, 0.012623469332530063 },
		  "Sigma+",
		  "Lab frame" },
		{ { 0.9571188840764735, 0.14999708735251072, 0.11449840686495108, -0.00015544686272713913 },
		  { 0.2322511159235265, -0.14933781305945262, -0.11584581640720129, 0.00015710917321815486 },
		  "Sigma+",
		  "Lab frame" },
		{ { 0.9571188840764735, -0.04981593212333629, 0.09065109034931539, -0.15919701716153598 },
		  { 0.2322511159235265, 0.04960466805539247, -0.09053723733301554, 0.15831754746376936 },
		  "Sigma+",
		  "Lab frame" },
		{ { 0.11374487063340005, -0.029810458493275623, 0.0001524244718277192, -0.029757615199904646 },
		  { 0.03040240553464517, -0.006226360548735683, -0.0001524287992397367, 0.029757611834139747 },
		  "Pi+",
		  "Moving frame" },
		{ { 0.11378896967067827, -0.029986859132942953, 0.011985747796768392, 0.027228045900935232 },
		  { 0.03035830649736688, -0.00604995990906833, -0.011985749720062623, -0.027228047343405903 },
		  "Pi+",
		  "Moving frame" },
		{ { 0.11612829086102268, -0.039344136554969336, -0.027683153012152906, 0.0027872266013977756 },
		  { 0.02801898530702296, 0.003307317512957928, 0.02768314483815243, -0.002787235256221811 },
		  "Pi+",
		  "Moving frame" },
		{ { 0.11574381244812161, -0.04091806834286667, 0.023101925449039978, -0.004994955398904342 },
		  { 0.026704222301982244, 0.012428461392845896, -0.023101933526683445, 0.00499494779641637 },
		  "Pi+",
		  "Moving frame" },
		{ { 0.11354874071578969, -0.02994270194498655, -0.023140252275811807, 0.017250697921032544 },
		  { 0.028899294034313867, 0.0014530949949658404, 0.023140247049101326, -0.017250700771965534 },
		  "Pi+",
		  "Moving frame" },
		{ { 1.5751841939921458, -0.2900957003157756, -0.7635639133365075, -1.3427048024964383 },
		  { 1.5855761328517055, -0.34205636505299475, 0.7635637341027606, 1.3427046759784993 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.4361892847652655, 0.07111018886554665, -0.8712963042756263, 1.1345757178811304 },
		  { 1.8485692012196655, -1.1660296841938569, 0.8712961837511022, -1.1345757507514553 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.3993003138117703, 0.5893229235805123, -0.4641938164145098, 1.176477907788559 },
		  { 1.7614600130320837, -1.221474988949283, 0.46419367935340916, -1.1764781186517907 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.3208497176674432, 0.7137219092234507, 0.23219507771552117, 1.0817424673077491 },
		  { 1.8776148489644986, -1.5133380508814358, -0.23219520574267385, -1.0817426486795487 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.772725943107887, -1.2778051584009855, -0.4277677916845439, 1.1470057844948662 },
		  { 1.3880343837359603, 0.6456530930322157, 0.4277677600550591, -1.147005921555967 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.2337962299481435, 1.0619359881073949, 0.13545977382895577, 0.6133477665655153 },
		  { 1.9646683366837965, -1.8615521297653796, -0.13545981650467334, -0.6133479586062442 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.4135187760446546, 0.13912144187793474, 0.46521589648545203, 1.3274993269971527 },
		  { 1.8712397099402809, -1.2340409372062464, -0.46521604988030096, -1.3274994475216768 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.383914772330854, 0.6662510710632537, -1.003753230381552, 0.6810350936341673 },
		  { 1.7768455545129973, -1.2984031364320243, 1.003753051147805, -0.6810352201521063 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.2572857429821165, 0.9679781101213514, -0.5947264280181328, 0.538596353987711 },
		  { 1.9411788236498178, -1.7675942517793348, 0.5947263533356271, -0.538596407332358 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.1732589943042868, 0.8599009177867258, -0.3008466447232731, 0.7393227404484963 },
		  { 2.111499491680653, -1.9548204131150388, 0.30084648037164924, -0.7393229267136701 },
		  "J/Psi",
		  "Moving frame" },
		{ { 57.7615873758275, 3.6333642980908523, -45.373628937373425, -35.51445065950848 },
		  { 74.92700011382841, -47.86289346130948, 45.37362495396005, 35.514443577884705 },
		  "Higgs",
		  "Moving frame" },
		{ { 70.75057607212932, -47.32170368159676, -52.53202394314101, -1.8787240848430755 },
		  { 56.929076770443956, 21.785773113082097, 52.53201925831275, 1.8787211035887241 },
		  "Higgs",
		  "Moving frame" },
		{ { 68.55438985938709, -28.745061100756562, 49.20893048023663, 38.06244554463423 },
		  { 64.13419763026876, -15.484468062462042, -49.208932693244066, -38.06245218365652 },
		  "Higgs",
		  "Moving frame" },
		{ { 87.56715769864913, -85.78335710636075, -11.49588863988425, 13.187496498670619 },
		  { 45.12142979100669, 41.55382794314215, 11.49588509907236, -13.187501809888454 },
		  "Higgs",
		  "Moving frame" },
		{ { 64.44663293935501, -16.42178970744079, -13.27123659856949, 60.863867505357724 },
		  { 68.24195455030092, -27.807739455777845, 13.271231287351654, -60.86387414438002 },
		  "Higgs",
		  "Moving frame" },
		{ { 1.0179527489704743, -0.3649055336699678, 0.1485228600295088, 0.025655656260667896 },
		  { 0.21042330502385304, 0.05781152017138605, -0.1485229255882523, -0.025655709527147005 },
		  "Sigma+",
		  "Moving frame" },
		{ { 1.0396731188015425, -0.411878357777925, 0.15150459581662426, -0.08926517694519263 },
		  { 0.22184426970822596, -0.008627438391997784, -0.15150465893616022, 0.08926513907347107 },
		  "Sigma+",
		  "Moving frame" },
		{ { 0.9920824713499821, -0.2691064201108605, -0.05776479373777583, 0.16768451101806156 },
		  { 0.2694349171597867, -0.15139937605906234, 0.0577647516580852, -0.1676845741375975 },
		  "Sigma+",
		  "Moving frame" },
		{ { 1.000682625606084, -0.314507336112602, 0.08132192668085077, -0.12443110132954928 },
		  { 0.21321304746643174, 0.07172820149809887, -0.08132199146677266, 0.12443103249450727 },
		  "Sigma+",
		  "Moving frame" },
		{ { 0.9728508855262158, -0.1844980457843809, 0.11724823911836123, -0.13526887672506094 },
		  { 0.25552516846811063, -0.1225959677142007, -0.11724829648226182, 0.13526883165342476 },
		  "Sigma+",
		  "Moving frame" },
		{ { 0.10869188216000604, -0.005614194912725393, 0.005452217664213397, -0.02460177643098898 },
		  { 0.033756152590097746, -0.022831202627529235, -0.005460653193608708, 0.02425686069889912 },
		  "Pi+",
		  "Moving frame" },
		{ { 0.11445520231948139, -0.034671298419146665, 0.021947947020096288, -0.01608974318605446 },
		  { 0.02799283243062215, 0.005985404180409335, -0.022178386376618727, 0.015996649087088307 },
		  "Pi+",
		  "Moving frame" },
		{ { 0.11102686142766338, -0.018913555081137415, -0.014851027003829804, 0.024159534412974484 },
		  { 0.03312041474038185, -0.017098394789858015, 0.01490113863027145, -0.02413633849005462 },
		  "Pi+",
		  "Moving frame" },
		{ { 0.10647640962048378, -0.0007400464198030484, 0.012334332452719797, 0.004117271799787114 },
		  { 0.03767086654756165, -0.03530019996558394, -0.012496192302259214, -0.004103077720315076 },
		  "Pi+",
		  "Moving frame" },
		{ { 0.12136490826634082, -0.054165786024096156, 0.025027152705261617, 0.008192670959595902 },
		  { 0.026671431908969062, 0.004249729954420188, -0.025038273970726964, -0.008148000488223691 },
		  "Pi+",
		  "Moving frame" },
		{ { 1.1864425754765335, 0.8110731512226501, 0.7878640689925388, -0.3315466795239965 },
		  { 2.0983159105083975, -1.9152696886254106, -0.7823499654191014, 0.33382108751532663 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.534705670229295, -0.14284913172793687, 0.0743722330294144, -1.5339122415199338 },
		  { 1.6637588964026424, -0.6579146961569792, -0.07396556818961217, 1.522697382738202 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.513910982803276, 0.016472476465423866, 0.5142572532532764, -1.3909500129257766 },
		  { 1.6468493440405767, -0.6484222395523549, -0.5212688985880279, 1.4173130929055116 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.6117357204350595, -0.44963663835347417, -0.19236039700723068, -1.531914834440265 },
		  { 1.5867288461968831, -0.3497947214201218, 0.1948361437788253, 1.5317399479131844 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.4527467980668418, 0.021513651243525868, 1.192305775218764, -0.8361647215788738 },
		  { 1.8320116879180892, -1.116357046351797, -1.1827974042963718, 0.8365646280202856 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.5971780757790826, -0.4053349281839211, -0.10058441130292595, -1.5556333397168631 },
		  { 1.5635822510647661, -0.2320867502669653, 0.10164083385437563, 1.542917391168024 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.7516267136585801, -1.1664876163553937, -1.2937747862540767, -0.05299253297000482 },
		  { 1.409133613185277, 0.5401563104164101, 1.3004139742821523, 0.0530276767140888 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.4698449439205195, -0.029821028374035243, 0.08708326853714782, 1.4869991440919073 },
		  { 1.8149135420644138, -1.0650625161204796, -0.08702653913359099, -1.4669625497232075 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.8492758740456117, -1.1803930004190202, 0.34481194970409, -1.3945467085071368 },
		  { 1.4354826119393225, 0.07322993665455929, -0.34676628683736155, 1.3910429852275634 },
		  "J/Psi",
		  "Moving frame" },
		{ { 1.5817473785867036, -0.36673201167180186, -1.447008677297577, -0.48098738450370326 },
		  { 1.7030111073982306, -0.7293555549114648, 1.46105554474506, 0.48332570849410106 },
		  "J/Psi",
		  "Moving frame" },
		{ { 58.37611993598947, 8.834810003177768, -13.383604722289801, 55.492559179923525 },
		  { 70.82660449349007, -41.05130416400552, 13.25076467545458, -56.14675711532853 },
		  "Higgs",
		  "Moving frame" },
		{ { 80.57508507925147, -80.34092956036342, -7.0070180924788685, 5.896904678804935 },
		  { 48.62763935022823, 47.744552011636095, 6.928279225863667, -5.826386315110518 },
		  "Higgs",
		  "Moving frame" },
		{ { 64.27448979386173, -14.909464935813457, -16.91017953354391, -60.03847912033941 },
		  { 63.40516304871163, -10.594655958003898, 16.966315356014857, 60.14112468308098 },
		  "Higgs",
		  "Moving frame" },
		{ { 51.64447820890335, 47.89600422846323, -4.285693637058352, -17.64673007736374 },
		  { 76.03517463366993, -73.74470809200531, 4.237350909471465, 17.94306093753263 },
		  "Higgs",
		  "Moving frame" },
		{ { 70.66514375468306, -35.04019766883572, -18.48819228671338, -58.17367998673591 },
		  { 62.02344373497291, -9.152226353383348, 18.602814763140596, 58.42878038219233 },
		  "Higgs",
		  "Moving frame" },
		{ { 0.958184762440172, -0.10347163054964914, -0.04833164619028151, -0.15981356797572605 },
		  { 0.2557109106323428, -0.14076115835153583, 0.048025059282951206, 0.15827014633475534 },
		  "Sigma+",
		  "Moving frame" },
		{ { 1.0015505157691134, -0.30081771074450336, -0.0009614025239172561, -0.18386448888542253 },
		  { 0.2599668727406564, -0.1229952974664676, 0.0009537492398077821, 0.18502838028280774 },
		  "Sigma+",
		  "Moving frame" },
		{ { 0.9404376917784476, -0.013116461079523032, 0.05657185076782979, 0.025245745562429183 },
		  { 0.2734579812940656, -0.2294964452911662, -0.0570073363326155, -0.02534348358857458 },
		  "Sigma+",
		  "Moving frame" },
		{ { 1.0062196795844485, -0.3440536145965328, 0.12089048460746186, -0.0177803096323597 },
		  { 0.2076759934880664, 0.0994135064805299, -0.12127089959684688, 0.017919858690080948 },
		  "Sigma+",
		  "Moving frame" },
		{ { 1.0245154414301059, -0.3929500835063485, 0.09720388314455275, 0.08210330687917339 },
		  { 0.20386061256422025, 0.08406228283768365, -0.09815963152976669, -0.08147912690448267 },
		  "Sigma+",
		  "Moving frame" },
	};
	for (size_t i = 0; i < nelem(test_data); i++)
	{
		auto &t = test_data[i];
		auto p = find_particle(t.v1, t.v2);
		assert(!strcmp(p, t.particle));
	}
	return 0;
}